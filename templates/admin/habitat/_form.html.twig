
{{ form_start(form) }}
    <div id="habitat-data" data-habitat-id="{{ habitat.id|default('') }}" data-remove-image-url="{{ path('app_admin_habitat_remove_image', { 'habitat': 'HABITAT_ID' }) }}">
        <button id="add-image-btn" type="button" class="btn btn-secondary mb-4 me-3">Ajouter une image</button>
        <div id="image-fields-list" data-prototype="{{ form_widget(form.images.vars.prototype)|e('html_attr') }}"></div>
        <div class="d-flex text-danger mt-3 d-none" id="image-error-bloc">
            {% include '_include/_components/_icons/_help_icon_svg.html.twig' %}
            <div id="image-error-message" class="text-danger ms-2"></div>
        </div>
    </div>
    
    {{ form_row(form.name) }}
    {{ form_row(form.shortdescription) }}
    {{ form_row(form.description) }}
    <div id="enclosures-container" data-prototype="{{ form_widget(form.enclosures.vars.prototype)|e('html_attr') }}">
    {% for enclosureForm in form.enclosures %}
        <hr>
        <div class="row enclosure-item mt-2">
            <div id="enclosure-data-{{ enclosureForm.id.vars.value }}" data-enclosure-id="{{ enclosureForm.id.vars.value|default('') }}" data-remove-image-url="{{ path('app_admin_enclosure_remove_image', { 'enclosure': 'ENCLOSURE_ID' }) }}">
                <button id="add-image-enclosure-btn-{{ enclosureForm.id.vars.value }}" type="button" class="btn btn-secondary mb-4 me-3">Ajouter une image pour l'enclos</button>
                <div id="image-enclosure-fields-list-{{ enclosureForm.id.vars.value }}" data-prototype="{{ form_widget(enclosureForm.images.vars.prototype)|e('html_attr') }}"></div>
                <div class="d-flex text-danger mt-3 d-none" id="image-enclosure-error-bloc-{{ enclosureForm.id.vars.value }}">
                    {% include '_include/_components/_icons/_help_icon_svg.html.twig' %}
                    <div id="image-enclosure-error-message" class="text-danger ms-2"></div>
                </div>
            </div>

            {{ form_row(enclosureForm.name) }}
            {{ form_row(enclosureForm.shortdescription) }}
            {{ form_row(enclosureForm.description) }}
            <a type='button' class="text-danger remove-enclosure text-end pt-2" title="Supprimer un enclos">
                {% include "_include/_components/_icons/_delete_icon_svg.html.twig" %}
            </a>
        </div>

        {# <template id="image-enclosure-field-template-{{ enclosureForm.id.vars.value }}" style="display: none;">
            {% include '_include/_components/_forms/_image-multi-upload-input.html.twig' %}
        </template> #}
    {% endfor %}
    </div>

    <button id="add-enclosure" type="button" class="btn btn-secondary mt-4">Ajouter un enclos</button>
    
<div class="mt-4 d-flex justify-content-between">
    <a type='button' class="btn btn-gradiant me-3 mb-2" title="revenir à la liste" href="{{ path('app_admin_habitat_index') }}">Revenir à la liste</a>

    {% if mode == 'Ajouter' %} 
        <button class="btn btn-primary" title="Valider">Valider</button>
    {% elseif mode == "Modifier" %}
        <button class="btn btn-primary" title="Valider">Valider</button>
    {% else %}
        <div class= "d-flex">
            <button class="btn btn-secondary" href="{{ path('app_admin_habitat_index') }}" title="valider">Valider</button>
            <button type='button' class="btn btn-danger me-3 mb-2"  data-bs-toggle="modal" data-bs-target="#deleteModal" title="supprimer">
                supprimer
            </button>
        </div>
    {% endif %}  
</div>

<template id="image-field-template" style="display: none;">
     {% include '_include/_components/_forms/_image-multi-upload-input.html.twig' %}
</template>

{% for enclosureForm in form.enclosures %}
<template id="image-enclosure-field-template-{{ enclosureForm.id.vars.value }}" style="display: none;">
     {% include '_include/_components/_forms/_image-multi-upload-input.html.twig' %}
</template>
{% endfor %}

<template id="remove-enclosure-template">
    <div class="enclosure-wrapper">
        <hr>
        <div class="enclosure-content">
            <!-- The contents of the enclosure will be inserted here -->
        </div>
        <div class="w-100 text-end">
            <a type='button' class="text-danger remove-enclosure pt-2" title="Supprimer">
                {% include "_include/_components/_icons/_delete_icon_svg.html.twig" %}
            </a>
        </div>
    </div>
</template>

{{ form_end(form) }}

<div class="col-12 pt-2">
    {% if delete_btn is defined %}
        {% include '/admin/habitat/_delete_modal.html.twig' with {'path_form' : path('app_admin_habitat_delete', {'id': habitat.id}), 'csrf_token': csrf_token, 'habitat': habitat } %}
    {% endif %}
</div>
